angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc","$rootScope","$location",function(t,o,e,n){t.$on("login",function(o,e){t.currentUser=e,console.log("login heard",e,t.currentUser)});var r=window.localStorage.token;return r?o.getUser().then(function(o){t.$emit("login",o),n.path("/posts")}):void 0}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc","$location",function(t,o,e){t.login=function(n,r){o.login(n,r).then(function(o){t.$emit("login",o),e.path("/")})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(t,o){console.log("PostsCtrl controller"),t.addPost=function(){t.postBody&&o.create({username:"gillyspy",body:t.postBody}).success(function(o){t.posts.unshift(o),t.postBody=null})},o.fetch().success(function(o){t.posts=o})}]),angular.module("app").service("PostsSvc",["$http",function(t){this.fetch=function(){return t.get("/api/posts")},this.create=function(o){return t.post("/api/posts",o)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc","$location",function(t,o,e){t.register=function(n,r){console.log("RegisterCtrl"),o.createUser(n,r).then(function(o){t.$emit("login",o),e.path("/")})}}]),angular.module("app").config(["$routeProvider","$locationProvider",function(t,o){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/posts",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).otherwise({redirectTo:"/"}),o.html5Mode(!0)}]),angular.module("app").service("UserSvc",["$http",function(t){var o=this;o.getUser=function(){return window.localStorage.token&&(t.defaults.headers.common["X-Auth"]=window.localStorage.token),t.get("/api/users").then(function(t){return t.data})},o.createUser=function(e,n){return t.post("/api/users",{username:e,password:n}).then(function(){return o.login(e,n)})},o.login=function(e,n){return t.post("/api/sessions",{username:e,password:n}).then(function(e){return window.localStorage.token=e.data,t.defaults.headers.common["X-Auth"]=e.data,o.getUser()})}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJsb2dpbi5jdHJsLmpzIiwicG9zdHMuY3RybC5qcyIsInBvc3RzLnN2Yy5qcyIsInJlZ2lzdGVyLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIlVzZXJTdmMiLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJG9uIiwiXyIsInVzZXIiLCJjdXJyZW50VXNlciIsImNvbnNvbGUiLCJsb2ciLCJhcHB0b2tlbiIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInRva2VuIiwiZ2V0VXNlciIsInRoZW4iLCIkZW1pdCIsInBhdGgiLCJsb2dpbiIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJQb3N0c1N2YyIsImFkZFBvc3QiLCJwb3N0Qm9keSIsImNyZWF0ZSIsImJvZHkiLCJzdWNjZXNzIiwicG9zdCIsInBvc3RzIiwidW5zaGlmdCIsImZldGNoIiwic2VydmljZSIsIiRodHRwIiwidGhpcyIsImdldCIsInJlZ2lzdGVyIiwiY3JlYXRlVXNlciIsImNvbmZpZyIsIiRyb3V0ZVByb3ZpZGVyIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwiaHRtbDVNb2RlIiwic3ZjIiwiZGVmYXVsdHMiLCJoZWFkZXJzIiwiY29tbW9uIiwicmVzcG9uc2UiLCJkYXRhIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFlDRkFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxTQUFBLFVBQUEsYUFBQSxZQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0FILEVBQUFJLElBQUEsUUFBQSxTQUFBQyxFQUFBQyxHQUdBTixFQUFBTyxZQUFBRCxFQUNBRSxRQUFBQyxJQUFBLGNBQUFILEVBQUFOLEVBQUFPLGNBSUEsSUFBQUcsR0FBQUMsT0FBQUMsYUFBQUMsS0FDQSxPQUFBSCxHQUNBVCxFQUFBYSxVQUNBQyxLQUFBLFNBQUFULEdBRUFOLEVBQUFnQixNQUFBLFFBQUFWLEdBQ0FILEVBQUFjLEtBQUEsWUFMQSxVQ1hBcEIsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGFBQUEsU0FBQSxVQUFBLFlBQUEsU0FBQUMsRUFBQUMsRUFBQUUsR0FDQUgsRUFBQWtCLE1BQUEsU0FBQUMsRUFBQUMsR0FDQW5CLEVBQ0FpQixNQUFBQyxFQUFBQyxHQUNBTCxLQUFBLFNBQUFULEdBRUFOLEVBQUFnQixNQUFBLFFBQUFWLEdBQ0FILEVBQUFjLEtBQUEsV0NQQXBCLFFBQ0FDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsV0FBQSxTQUFBQyxFQUFBcUIsR0FDQWIsUUFBQUMsSUFBQSx3QkFFQVQsRUFBQXNCLFFBQUEsV0FDQXRCLEVBQUF1QixVQUNBRixFQUFBRyxRQUNBTCxTQUFBLFdBQ0FNLEtBQUF6QixFQUFBdUIsV0FDQUcsUUFBQSxTQUFBQyxHQUNBM0IsRUFBQTRCLE1BQUFDLFFBQUFGLEdBQ0EzQixFQUFBdUIsU0FBQSxRQU9BRixFQUFBUyxRQUNBSixRQUFBLFNBQUFFLEdBQ0E1QixFQUFBNEIsTUFBQUEsT0NyQkEvQixRQUFBQyxPQUFBLE9BQ0FpQyxRQUFBLFlBQUEsUUFBQSxTQUFBQyxHQUdBQyxLQUFBSCxNQUFBLFdBQ0EsTUFBQUUsR0FBQUUsSUFBQSxlQUlBRCxLQUFBVCxPQUFBLFNBQUFHLEdBQ0EsTUFBQUssR0FBQUwsS0FBQSxhQUFBQSxPQ1hBOUIsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGdCQUFBLFNBQUEsVUFBQSxZQUFBLFNBQUFDLEVBQUFDLEVBQUFFLEdBQ0FILEVBQUFtQyxTQUFBLFNBQUFoQixFQUFBQyxHQUVBWixRQUFBQyxJQUFBLGdCQUNBUixFQUNBbUMsV0FBQWpCLEVBQUFDLEdBQ0FMLEtBQUEsU0FBQVQsR0FFQU4sRUFBQWdCLE1BQUEsUUFBQVYsR0FDQUgsRUFBQWMsS0FBQSxXQ1ZBcEIsUUFBQUMsT0FBQSxPQUNBdUMsUUFFQSxpQkFDQSxvQkFDQSxTQUFBQyxFQUFBQyxHQUdBRCxFQUNBRSxLQUFBLEtBQ0F6QyxXQUFBLFlBQ0EwQyxZQUFBLGVBRUFELEtBQUEsVUFDQXpDLFdBQUEsWUFDQTBDLFlBQUEsZUFHQUQsS0FBQSxhQUNBekMsV0FBQSxlQUNBMEMsWUFBQSxrQkFFQUQsS0FBQSxVQUNBekMsV0FBQSxZQUNBMEMsWUFBQSxlQUdBQyxXQUNBQyxXQUFBLE1BS0FKLEVBQUFLLFdBQUEsTUNqQ0EvQyxRQUFBQyxPQUFBLE9BQ0FpQyxRQUFBLFdBQUEsUUFBQSxTQUFBQyxHQUNBLEdBQUFhLEdBQUFaLElBQ0FZLEdBQUEvQixRQUFBLFdBSUEsTUFIQUgsUUFBQUMsYUFBQUMsUUFDQW1CLEVBQUFjLFNBQUFDLFFBQUFDLE9BQUEsVUFBQXJDLE9BQUFDLGFBQUFDLE9BRUFtQixFQUFBRSxJQUFBLGNBQ0FuQixLQUFBLFNBQUFrQyxHQUNBLE1BQUFBLEdBQUFDLFFBSUFMLEVBQUFULFdBQUEsU0FBQWpCLEVBQUFDLEdBRUEsTUFBQVksR0FBQUwsS0FBQSxjQUNBUixTQUFBQSxFQUNBQyxTQUFBQSxJQUNBTCxLQUFBLFdBQ0EsTUFBQThCLEdBQUEzQixNQUFBQyxFQUFBQyxNQUtBeUIsRUFBQTNCLE1BQUEsU0FBQUMsRUFBQUMsR0FDQSxNQUFBWSxHQUFBTCxLQUFBLGlCQUNBUixTQUFBQSxFQUNBQyxTQUFBQSxJQUVBTCxLQUFBLFNBQUFrQyxHQU9BLE1BTEF0QyxRQUFBQyxhQUFBQyxNQUFBb0MsRUFBQUMsS0FJQWxCLEVBQUFjLFNBQUFDLFFBQUFDLE9BQUEsVUFBQUMsRUFBQUMsS0FDQUwsRUFBQS9CIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vaW5zdGFudGlhdGUgdGhlIGRlY2xhcmVkIGFuZ3VsYXIgYXBwXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuICAgICduZ1JvdXRlJ1xuXSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsICRyb290U2NvcGUsICRsb2NhdGlvbikge1xuICAgICAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uIChfLCB1c2VyKSB7XG5cbiAgICAgICAgICAgIC8vIG9uIGxvZ2luIGdldCB0aGUgYnViYmxlZCB1cCB1c2VyXG4gICAgICAgICAgICAkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2xvZ2luIGhlYXJkJywgdXNlciwgJHNjb3BlLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIGxvZ2luIHByZXZpb3VzIHVzZXIgaWYgdGhleSBoYXZlIGFuIGV4aXN0aW5nIHRva2VuXG4gICAgICAgIC8vVE9ETzogbG9vayBpbnRvIHVzaW5nIGNvb2tpZXMgdG8gc3RvcmUgdGhlIEpXVFxuICAgICAgICB2YXIgYXBwdG9rZW4gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuO1xuICAgICAgICBpZiAoISFhcHB0b2tlbikge1xuICAgICAgICAgICAgcmV0dXJuIFVzZXJTdmMuZ2V0VXNlcigpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy90cmlnZ2VyIGFuIHVwZGF0ZSBvZiBhcHBsaWNhdGlvbiBsZXZlbCBpbnRlcnBvbGF0ZWQgdmFyaWFibGVcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnL3Bvc3RzJyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgO1xuXG4gICAgfSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsICRsb2NhdGlvbikge1xuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICBVc2VyU3ZjXG4gICAgICAgICAgICAgICAgLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCkgLy9sb2dpbiBub3cgcmV0dXJucyB0aGUgZGF0YTtcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgICAgICAgICAgICAvLyBidWJibGUgdXAgdGhlIGxvZ2dlZCBpbiByZXNwb25zZSBpbmZvIChBcHBsaWNhdGlvbiBjb250cm9sbGVyIHdpbGwgbGlzdGVuIGZvciBpdClcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICAkbG9jYXRpb24ucGF0aCgnLycpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgIH0pO1xuIiwiLy8gY3JlYXRlIGEgY29udHJvbGxlciBhbmQgaW5qZWN0IG91ciBzZXJ2aWNlXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnYXBwJylcbiAgICAuY29udHJvbGxlcignUG9zdHNDdHJsJywgZnVuY3Rpb24gKCRzY29wZSwgUG9zdHNTdmMpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ1Bvc3RzQ3RybCBjb250cm9sbGVyJyk7XG5cbiAgICAgICAgJHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLnBvc3RCb2R5KSB7XG4gICAgICAgICAgICAgICAgUG9zdHNTdmMuY3JlYXRlKHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcm5hbWU6ICdnaWxseXNweScsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6ICRzY29wZS5wb3N0Qm9keVxuICAgICAgICAgICAgICAgIH0pLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdCk7XG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5wb3N0Qm9keSA9IG51bGw7XG4gICAgICAgICAgICAgICAgfSk7IC8vIHN1Y2Nlc3NcbiAgICAgICAgICAgIH0gLy8gZW5kaWY7XG4gICAgICAgIH0gLy8gZW5kIGFkZFBvc3Q7XG4gICAgICAgIDtcblxuICAgICAgICAvLyB2aWEgQVBJIHNlcnZpY2VcbiAgICAgICAgUG9zdHNTdmMuZmV0Y2goKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLnBvc3RzID0gcG9zdHM7XG4gICAgICAgICAgICB9KVxuICAgICAgICA7XG5cbiAgICB9KVxuOyAvLyBlbmQgY29udHJvbGxlclxuXG4iLCIvLyBuZyBzZXJ2aWNlIGZvciBsb2FkaW5nIHBvc3RzXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbiAgICAuc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbiAoJGh0dHApIHtcblxuICAgICAgICAvLyBhZGQgYSBmZXRjaCBtZXRob2QgdG8gb3VyIHNlcnZpY2VcbiAgICAgICAgdGhpcy5mZXRjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKTtcbiAgICAgICAgfTsgLy8gZmV0Y2g7XG5cbiAgICAgICAgLy8gYWRkIGEgY3JlYXRlIG1ldGhvZCB0byBvdXIgc2VydmljZVxuICAgICAgICB0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uIChwb3N0KSB7XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuICAgICAgICB9OyAvL2NyZWF0ZTtcbiAgICAgICAgXG4gICAgfSk7Ly8gc2VydmljZSgpXG5cblxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMsICRsb2NhdGlvbikge1xuICAgICAgICAkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZWdpc3RlckN0cmwnKTtcbiAgICAgICAgICAgIFVzZXJTdmNcbiAgICAgICAgICAgICAgICAuY3JlYXRlVXNlcih1c2VybmFtZSwgcGFzc3dvcmQpIC8vbG9naW4gbm93IHJldHVybnMgdGhlIGRhdGE7XG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnViYmxlIHVwIHRoZSBsb2dnZWQgaW4gcmVzcG9uc2UgaW5mbyAoQXBwbGljYXRpb24gY29udHJvbGxlciB3aWxsIGxpc3RlbiBmb3IgaXQpXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJy8nKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgO1xuICAgICAgICB9O1xuICAgIH0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4gICAgLmNvbmZpZyhcbiAgICAgICAgW1xuICAgICAgICAgICAgJyRyb3V0ZVByb3ZpZGVyJyxcbiAgICAgICAgICAgICckbG9jYXRpb25Qcm92aWRlcicsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG5cbiAgICAgICAgICAgICAgICAvL3JvdXRlIChpLmUuIFVSTCkgcm91dGluZyBsb2dpYyBvbiBjbGllbnQgc2lkZVxuICAgICAgICAgICAgICAgICRyb3V0ZVByb3ZpZGVyXG4gICAgICAgICAgICAgICAgICAgIC53aGVuKCcvJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1Bvc3RzQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3Bvc3RzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH0pIC8vIHJvb3RcbiAgICAgICAgICAgICAgICAgICAgLndoZW4oJy9wb3N0cycsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9KSAvLyBwb3N0XG5cbiAgICAgICAgICAgICAgICAgICAgLndoZW4oJy9yZWdpc3RlcicsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9KSAvLyByZWdpc3RlclxuICAgICAgICAgICAgICAgICAgICAud2hlbignL2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAgICAgLm90aGVyd2lzZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWRpcmVjdFRvOiAnLydcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICA7Ly8gZGVmYXVsdCBpcyByb290XG5cbiAgICAgICAgICAgICAgICAvL2h0bWw1IG1vZGUgZm9yIGhhc2hsZXNzIFVSTHNcbiAgICAgICAgICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICApOyAvLyBjb25maWc7XG4vL21vZHVsZSA7XG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuICAgIC5zZXJ2aWNlKCdVc2VyU3ZjJywgZnVuY3Rpb24gKCRodHRwKSB7XG4gICAgICAgIHZhciBzdmMgPSB0aGlzO1xuICAgICAgICBzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghIXdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4pIHtcbiAgICAgICAgICAgICAgICAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldCgnL2FwaS91c2VycycpXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5kYXRhXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc3ZjLmNyZWF0ZVVzZXIgPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICAvL1RPRE86XG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2VycycsIHtcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9O1xuXG4gICAgICAgIHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuICAgICAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vVE9ETzogc3RvcmUgdGhpcyB0b2tlbiBpbiBzb21ldGhpbmcgdGhhdCBwZXJzaXN0c1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gcmVzcG9uc2UuZGF0YTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzZW5kIHVwIHRoZSBYLWF1dGggcmVxdWVzdCBvbiBBTEwgcmVxdWVzdHNcbiAgICAgICAgICAgICAgICAgICAgLy9OT1RFOiBJIGRvbid0IHVuZGVyc3RhbmQgeWV0IGhvdyB0aGlzIGlzIHJlbGV2YW50IHRvIGFsbCByZXF1ZXN0cyB5ZXRcbiAgICAgICAgICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHN2Yy5nZXRVc2VyKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9KVxuOyJdfQ==
